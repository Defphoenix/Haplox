echo;date
perl/thinker/net/ctDNA/Bed/add_geneinfo_to_bed.pl -i/thinker/net/ctDNA/GRCh37.p13_2017_01_13.gff  -i1 /thinker/net/ctDNA/Gene_transcript_new.list -i2  /haplox/users/chenyr/Panel_Design/HapOnco1326/HapOnco1326_probe.exp100.bed -o  /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/cnv/analysis.bed   
python /thinker/net/ctDNA/cnvkit-0.9.6/cnvkit-0.9.6/cnvkit.py  batch  /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.cfDNA.gencore.sort.bam   -n  /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.gDNA.gencore.sort.bam -t /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/cnv/analysis.bed  -f   /thinker/net/ctDNA/WES_ref/hg19.fa   --access   /thinker/net/ctDNA/access-5k-mappable.hg19.bed  -d  /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/cnv  > /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.cnv.log 2>&1 && perl /thinker/net/ctDNA/cnv_filter_wesplus.pl   -l /thinker/net/ctDNA/final.cnv.genelist  -c /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/cnv/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.cfDNA.gencore.sort.cns  -o /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/cnv/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.cnv.result && perl /haplox/users/xuyun/script/result_extract.pl -i /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531 -s S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531 && rm    /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/cnv/analysis.bed & 
java -jar /thinker/net/ctDNA/VarScan.v2.4.3.jar somatic /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.gDNA.gencore.mpileup /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.cfDNA.gencore.mpileup --output-snp /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp.vcf --output-indel /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel.vcf --min-coverage-tumor 80 --min-coverage-normal 60 --min-var-freq 0.0001 --min-freq-for-hom 0.90 --normal-purity 1 --tumor-purity 0.01 --p-value 0.99 --somatic-p-value 0.05 --strand-filter 1 --output-vcf 1
/thinker/net/ctDNA/annovar/table_annovar.pl /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp.vcf /thinker/net/ctDNA/annovar/humandb/ -buildver hg19 -out /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp -remove -protocol refGene,cytoBand,genomicSuperDups,esp6500siv2_all,1000g2015aug_all,1000g2015aug_afr,1000g2015aug_eas,1000g2015aug_eur,snp138,ljb26_all,cosmic87,clinvar_20180603 -operation g,r,r,f,f,f,f,f,f,f,f,f -nastring . -vcfinput
/thinker/net/ctDNA/annovar/table_annovar.pl /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel.vcf /thinker/net/ctDNA/annovar/humandb/ -buildver hg19 -out /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel -remove -protocol refGene,cytoBand,genomicSuperDups,esp6500siv2_all,1000g2015aug_all,1000g2015aug_afr,1000g2015aug_eas,1000g2015aug_eur,snp138,ljb26_all,cosmic87,clinvar_20180603 -operation g,r,r,f,f,f,f,f,f,f,f,f -nastring . -vcfinput
perl /thinker/net/ctDNA/check_snp.v1.pl /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp.hg19_multianno.txt > /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.check.result
perl /thinker/net/ctDNA/check.pl /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp.hg19_multianno.txt > /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.check.contaminate
perl /thinker/net/ctDNA/filter_pair_step1.pl -i /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp.hg19_multianno.txt -o /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp.hg19_multianno.txt.filter
perl /thinker/net/ctDNA/filter_pair_step1.pl -i /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel.hg19_multianno.txt -o /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel.hg19_multianno.txt.filter
/thinker/net/ctDNA/MrBam_new/paraMrBam 10 /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp.hg19_multianno.txt.filter  --cfdna /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.cfDNA.gencore.sort.bam --gdna /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.gDNA.gencore.sort.bam -m 2 -q 25 --fast --snp >/haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp_Test_MrBam.txt
/thinker/net/ctDNA/MrBam_new/paraMrBam 10 /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel.hg19_multianno.txt.filter  --cfdna /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.cfDNA.gencore.sort.bam --gdna /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.gDNA.gencore.sort.bam -m 2 -q 25 --fast --indel >/haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel_Test_MrBam.txt
/thinker/net/ctDNA/baselineanno4 -i /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp_Test_MrBam.txt -o /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp_Test_MrBam.baseline -t 1 -redis  Haplox2022*#@10.6.12.2:6379 -anno 6
/thinker/net/ctDNA/baselineanno4 -i /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel_Test_MrBam.txt -o /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel_Test_MrBam.baseline -t 1 -redis  Haplox2022*#@10.6.12.2:6379 -anno 6
/thinker/net/ctDNA/extract.v2.pl /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp_Test_MrBam.baseline /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp_Test.txt
/thinker/net/ctDNA/extract.v2.pl /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel_Test_MrBam.baseline /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel_Test.txt
/thinker/net/ctDNA/filter2_v2.py true 605v2 /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.snp_Test.txt /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.indel_Test.txt /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.filter_Test.log >/haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.filter_Test.result
perl /thinker/net/ctDNA/baseline_anno_v2.pl /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.filter_Test.result 1 >  /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/somatic/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.filter_Test.result.baseline
rm /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531.cfDNA.gencore.mpileup  /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/*DNA.gencore.bam /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/*gz &&  rm /haplox/users/chenyr/Project/1326Panel/S208_SZ20221230010DNA-d_gdna_BK2302-1326_111531/bam/*depth 